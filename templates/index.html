{% extends 'base.html' %}

{% block content %}
<h2>Tasks</h2>

<div class="task-column">
    {% if tasks %}
    <ul>
        {% for task in tasks %}
        <li>
            {{ "✅" if task.completed else "❌" }} {{ task.name }} ({{ task.category }})
            {% set elapsed = task.get_elapsed() %}
            {% set mins = (elapsed // 60) | int %}
            {% set secs = (elapsed % 60) | int %}
            ⏱ {{ "%02d"|format(mins) }}:{{ "%02d"|format(secs) }}

            {% if not task.completed %}
            <a href="{{ url_for('complete_task', task_id=task.id) }}">✅ Mark complete</a>
            {% endif %}

            <!-- Timer control buttons -->
            <form action="{{ url_for('start_timer', task_id=task.id) }}" method="post" style="display:inline;">
                <button type="submit">▶️ Start</button>
            </form>
            <form action="{{ url_for('stop_timer', task_id=task.id) }}" method="post" style="display:inline;">
                <button type="submit">⏸️ Stop</button>
            </form>
            <form action="{{ url_for('reset_timer', task_id=task.id) }}" method="post" style="display:inline;">
                <button type="submit">🔄 Reset</button>
            </form>

            <!-- Delete button -->
            <form action="{{ url_for('delete', task_id=task.id) }}" method="post" style="display:inline;">
                <button type="submit">🗑️ Delete</button>
            </form>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No tasks yet!</p>
    {% endif %}

    <h3>Add Task</h3>
    <form method="POST" action="{{ url_for('add_task') }}">
        <input type="text" name="name" placeholder="Task name" required>
        <input type="text" name="category" placeholder="Category (optional)">
        <button type="submit">Add</button>
    </form>
</div>
{% endblock %}
